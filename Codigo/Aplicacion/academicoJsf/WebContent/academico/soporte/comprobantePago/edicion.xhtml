<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

<ui:composition
	template="/componentesGenerales/plantillas/pltPrincipalSinMenuEjecModal.xhtml">
	<ui:define name="paginacion">
		<ui:include src="/componentesGenerales/plantillas/pltPaginacion.xhtml">
			<ui:param name="pagina"
			value="Soporte / Comprobante de pago / Edición" />
				
		</ui:include>
	</ui:define>


	<ui:define name="cuerpo">

		<script language="JavaScript">
//<![CDATA[
	function verificarErrores(){
    	var idVarError = 'compOculto:txtValidador';
    	var varError = document.getElementById(idVarError);
    	if(varError.value == 1){
    		document.getElementById('frmEditarComprobante:btnGenerarNuevoComprobanteModal').click();
    	}
    	
    	//if(varError.value == 2){
    //		document.getElementById('frmNuevoParalelo:btnEditarParaleloValidarModal').click();
     //   }
    } 
    
    function nobackbutton(){
   		window.location.hash="no-back-button";
   		window.location.hash="Again-No-back-button" //chrome
   		window.onhashchange=function(){window.location.hash="no-back-button";}
	}
    
 //]]> 
</script>

		<h:form id="frmEditarComprobante" enctype="multipart/form-data" 	acceptcharset="UTF-8">
				
			<!-- *************************************************************************************************** -->
			<!-- **********************************PANEL IDENTIFICACION DEL PUESTO********************************** -->
			<p:panel id="pnlDatos" header="Datos de comprobante de pago">
				<!-- ******************** TABLA RESPONSIVA ************************ -->
				<div class="grid condensed" >
				<div class="row cells8">
		     		<div class="cell colspan4" >
		       			<ui:decorate  template="/componentesGenerales/plantillas/pltComponenteGeneralEdit.xhtml">
		       				<ui:define name="etiqueta">	
		       					<p:outputLabel id="lblNumComprobante" for="txtNumComprobante" value="Número de comprobante"/>	
		       				</ui:define>
		       				<ui:define name="valor">	
		       					<p:inputText id="txtNumComprobante" value="#{edicionComprobantePagoForm.ecpfNumComprobante}"
		       								style="width:100%" maxlength="10" required="true" requiredMessage="Campo requerido"
		       								disabled="#{edicionComprobantePagoForm.ecpfValidadorBuscar}">
		       					<p:ajax event="blur" update="txtNumComprobante" />
								</p:inputText>	
		       				</ui:define>
		       				<ui:define name="etiquetaError">
								<p:message id="msgNumComprobante" for="txtNumComprobante" />
							</ui:define>
		       			</ui:decorate>
		        	</div>
		    	</div>
 				<p:commandButton id="btnBuscar" value="Buscar comprobante" ajax="false" update="pnlResultados , msgNumComprobante , 
 				lblNumComprobante, txtIdComprobante , txtDescripcion"
				action="#{edicionComprobantePagoForm.buscarComprobantes()}" disabled="#{edicionComprobantePagoForm.ecpfValidadorBuscar}"
				onclick="PF('dialogoTrabajando').show();" 
		    	oncomplete="PF('dialogoTrabajando').hide();"/>
				<p:commandButton id="btnLimpiar" value="Limpiar" immediate="true" ajax="false" 
				action="#{edicionComprobantePagoForm.limpiar()}" update="pnlResultados , msgNumComprobante , 
 				lblNumComprobante, txtIdComprobante , txtDescripcion "/>
			</div>
			</p:panel>
			<p:panel id="pnlResultados" header="Resultados de la búsqueda" >
			<p:dataTable id="dtsUsuario" var="item" value="#{edicionComprobantePagoForm.ecpfListaComprobantePago}"
		    		 		rows="10" paginator="true"
		                         paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
		                         rowsPerPageTemplate="5,10,15" emptyMessage="NO SE ENCONTRARON COMPROBANTES CON LOS PARÁMETROS DE BÚSQUEDA INGRESADOS">
		    			<p:column headerText="identificación"  style="width: 1em ! important; text-align:center">
				            <h:outputText value="#{item.prsIdentificacion}" />
				        </p:column>
		    			<p:column headerText="Num. comprobante"  style="width: 1em ! important; text-align:center">
				            <h:outputText value="#{item.cmpaNumComprobante}" />
				        </p:column>
				        <p:column headerText="Fecha de emisión"  style="width: 3em ! important; text-align:center">
				            <h:outputText value="#{item.fechaEmision}"/>
				        </p:column>
				        <p:column headerText="Fecha de caducidad"  style="width: 3em ! important; text-align:center">
				            <h:outputText value="#{item.fechaCaduca}"/>
				        </p:column>
				        <p:column headerText="Monto a pagar"  style="width: 4em ! important; text-align:center">
				            <h:outputText value="#{item.cmpaTotalPago}">
				            <f:convertNumber pattern="#0.00" />
				            </h:outputText>
				        </p:column>
				         <p:column headerText="Estado usuario" style="width: 2em ! important; text-align:center">
				            <h:outputText value="#{listasCombosForm.getLabelEstadoComprobante(item.cmpaEstado)}"/>
				        </p:column>
				         <p:column headerText="Opción"  style="width: 3em ! important;text-align:center">
					        	<p:commandLink id="cmdlVer" value="Editar número de comprobante" action="#{edicionComprobantePagoForm.editarNumComprobante(item)}" 
					        	ajax="false" style="color:blue;"/>
					        	
					        </p:column>
			</p:dataTable>
		</p:panel>
			<div>
				<p:commandButton id="btnRegresar" value="Cancelar" immediate="true" ajax="false" 
				action="#{edicionComprobantePagoForm.irInicio()}" />
			
<!-- 				<p:commandButton id="btnGuardarEdicion" value="Actualizar fechas"  -->
<!-- 				action="#{edicionComprobantePagoForm.verificarClickGuardarEdicion()}" -->
<!-- 									ajax="false" update="pnlResultados"/> -->
				<p:commandButton id="btnGenerarNuevoComprobanteModal" value="EjecutarModalNuevoComprobante" 
					style="visibility:hidden;">
				<p:ajax oncomplete="PF('dialogoEditarComprobante').show();" update=":frmModalCrearNuevo" />
				</p:commandButton>  
				    
			</div>
		</h:form>

		    <ui:include	src="/academico/soporte/comprobantePago/modalEditarComprobante.xhtml" />
		    
  
       <h:form id="compOculto" style="visibility:hidden;">
			<p:inputText id="txtValidador" value="#{edicionComprobantePagoForm.ecpfValidadorClick}">
			</p:inputText> 
		</h:form>
		
	
		</ui:define>	
</ui:composition>

</html>
