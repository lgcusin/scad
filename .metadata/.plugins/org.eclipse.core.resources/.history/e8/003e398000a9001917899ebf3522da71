package ec.edu.uce.Biometrico.jsf.managedBeans;

import java.util.List;

import javax.annotation.PostConstruct;
import javax.ejb.EJB;
import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.ViewScoped;
import javax.faces.context.FacesContext;
import javax.faces.event.ValueChangeEvent;

import ec.edu.uce.Biometrico.ejb.servicios.interfaces.SrvEmpleadoLocal;
import ec.uce.edu.biometrico.jpa.Carrera;

@ManagedBean(name = "generarRegistros")
@ViewScoped
public class generarRegistros {

	@EJB
	private SrvEmpleadoLocal srvEmp;
	private Login beanLogin;

	private Carrera selectCarrera;
	private List<Carrera> lstCarrera;

	@PostConstruct
	public void init() {
		FacesContext context = FacesContext.getCurrentInstance();
		beanLogin = context.getApplication().evaluateExpressionGet(context, "#{login}", Login.class);
		lstCarrera = srvEmp.listarCarreras(beanLogin.getUsuarioRol().getUsuario().getPersona().getFichaEmpleados()
				.get(0).getDetallePuestos().get(0).getCarrera().getDependencia().getDpnId());
		iniciarBean();
	}

	private void iniciarBean() {
		selectCarrera = new Carrera();

	}

	public void setFacultadID(ValueChangeEvent event) {
		if (event.getNewValue() != null) {
			selectCarrera.setCrrId((Integer) event.getNewValue());
		} else {
			selectCarrera.setCrrId(null);
			FacesMessage msg = new FacesMessage(FacesMessage.SEVERITY_WARN, "No se ha seleccionado una carrera.",
					"Warning!");
			FacesContext.getCurrentInstance().addMessage(null, msg);
		}
	}

	/**
	 * @return the selectCarrera
	 */
	public Carrera getSelectCarrera() {
		return selectCarrera;
	}

	/**
	 * @param selectCarrera
	 *            the selectCarrera to set
	 */
	public void setSelectCarrera(Carrera selectCarrera) {
		this.selectCarrera = selectCarrera;
	}

	// GETTERS AND SETTERS

}
