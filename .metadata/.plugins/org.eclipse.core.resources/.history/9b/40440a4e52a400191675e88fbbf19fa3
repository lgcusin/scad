package ec.edu.uce.Biometrico.jsf.managedBeans;

import java.util.List;

import javax.annotation.PostConstruct;
import javax.ejb.EJB;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.RequestScoped;
import javax.faces.bean.SessionScoped;
import javax.faces.context.FacesContext;

import ec.edu.uce.Biometrico.ejb.servicios.impl.SrvDocente;
import ec.edu.uce.Biometrico.ejb.servicios.impl.SrvLogin;
import ec.edu.uce.Biometrico.ejb.servicios.interfaces.SrvLoginLocal;
import ec.uce.edu.biometrico.jpa.DetallePuesto;
import ec.uce.edu.biometrico.jpa.FichaDocente;
import ec.uce.edu.biometrico.jpa.FichaEmpleado;
import ec.uce.edu.biometrico.jpa.Usuario;

@ManagedBean(name = "login")
@SessionScoped
public class Login {

	@EJB
	private SrvLoginLocal srvlgn;
	private Usuario usuario;
	private List<DetallePuesto> dt;
	boolean Docente = false;
	boolean Empleado = false;

	public String nick;
	public String clave;

	@PostConstruct
	public void init() {
		usuario = new Usuario();
	}

	public String ingresar() {

		usuario = srvlgn.verificar(nick, clave);

		if (usuario.getUsuarioRols().get(0).getRol().getRolId() == 22) {
			if (usuario.getPersona().getPrsId() != 0) {
				Docente = true;
			}
			if (usuario.getUsuarioRols().get(0).getRol().getRolId() == 0) {
				Empleado = true;
			}
			dt = srvlgn.buscarDetallePuesto(usuario.getPersona().getFichaDocentes().get(0).getFcdcId());
			usuario.getPersona().getFichaDocentes().get(0).setDetallePuestos(dt);
			return "principal";
		} else {
			System.out.println("usuario o contrase√±a no validos");
			return "errorLogin";
		}

	}

	public String getNick() {
		return nick;
	}

	public void setNick(String nick) {
		this.nick = nick;
	}

	public String getClave() {
		return clave;
	}

	public void setClave(String clave) {
		this.clave = clave;
	}

	public Usuario getUsuario() {
		return usuario;
	}

	public void setUsuario(Usuario usr) {
		this.usuario = usr;
	}

	public boolean isDocente() {
		return Docente;
	}

	public void setDocente(boolean docente) {
		Docente = docente;
	}

	public boolean isEmpleado() {
		return Empleado;
	}

	public void setEmpleado(boolean empleado) {
		Empleado = empleado;
	}

	public List<DetallePuesto> getDt() {
		return dt;
	}

	public void setDt(List<DetallePuesto> dt) {
		this.dt = dt;
	}

}
